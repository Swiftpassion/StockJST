import streamlit as st
import pandas as pd
import io
import json
from google.oauth2 import service_account
from googleapiclient.discovery import build
from googleapiclient.http import MediaIoBaseDownload
import gspread

# ==========================================
# 1. ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÅ‡∏•‡∏∞‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£
# ==========================================
st.set_page_config(page_title="JST Smart Dashboard", layout="wide")

# ‡πÉ‡∏™‡πà ID ‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ
FOLDER_ID_DATA_SALE = "1jFoara-yXT8FKy1hVjs3MyedG7O6lZRi"
FOLDER_ID_DATA_STOCK = "1x3K-oekbzob1f2wmgRkQfRx8Y4DY5Sq3"

# ==========================================
# 2. ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Google Cloud (Drive & Sheets) - ‡∏â‡∏ö‡∏±‡∏ö‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç
# ==========================================
@st.cache_resource
def get_credentials():
    scope = [
        "https://www.googleapis.com/auth/spreadsheets",
        "https://www.googleapis.com/auth/drive"
    ]
    
    # ‡∏Å‡∏£‡∏ì‡∏µ‡∏£‡∏±‡∏ô‡∏ö‡∏ô Streamlit Cloud
    if "gcp_service_account" in st.secrets:
        secret_value = st.secrets["gcp_service_account"]
        
        # ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ Streamlit ‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏õ‡πá‡∏ô Dict ‡πÉ‡∏´‡πâ‡πÅ‡∏•‡πâ‡∏ß‡∏´‡∏£‡∏∑‡∏≠‡∏¢‡∏±‡∏á (‡∏Å‡∏£‡∏ì‡∏µ‡πÉ‡∏™‡πà‡πÅ‡∏ö‡∏ö TOML)
        if isinstance(secret_value, dict):
            creds_dict = secret_value
        else:
            # ‡∏Å‡∏£‡∏ì‡∏µ‡πÄ‡∏õ‡πá‡∏ô String (‡πÉ‡∏™‡πà‡πÅ‡∏ö‡∏ö JSON ‡πÉ‡∏ô‡∏ü‡∏±‡∏ô‡∏´‡∏ô‡∏π 3 ‡∏ï‡∏±‡∏ß)
            try:
                creds_dict = json.loads(secret_value)
            except json.JSONDecodeError:
                st.error("‚ùå ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö JSON ‡πÉ‡∏ô Secrets ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏õ‡∏µ‡∏Å‡∏Å‡∏≤ { } ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏´‡∏°‡∏≤‡∏¢‡∏ü‡∏±‡∏ô‡∏´‡∏ô‡∏π")
                return None

        # ‡πÅ‡∏Å‡πâ‡∏õ‡∏±‡∏ç‡∏´‡∏≤ \n ‡πÉ‡∏ô Private Key
        if "private_key" in creds_dict:
            creds_dict["private_key"] = creds_dict["private_key"].replace("\\n", "\n")
            
        return service_account.Credentials.from_service_account_info(creds_dict, scopes=scope)

    # ‡∏Å‡∏£‡∏ì‡∏µ‡∏£‡∏±‡∏ô‡πÉ‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á (Local)
    else:
        try:
            return service_account.Credentials.from_service_account_file("credentials.json", scopes=scope)
        except Exception:
            st.warning("‡πÑ‡∏°‡πà‡∏û‡∏ö‡πÑ‡∏ü‡∏•‡πå credentials.json ‡πÉ‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á")
            return None
# ==========================================
# 3. ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÅ‡∏•‡∏∞‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå‡∏à‡∏≤‡∏Å‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå
# ==========================================
def get_latest_dataframe_from_folder(folder_id, file_type="stock"):
    creds = get_credentials()
    service = build('drive', 'v3', credentials=creds)
    
    try:
        # 1. ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏ô‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå (‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ï‡∏≤‡∏°‡πÄ‡∏ß‡∏•‡∏≤‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î)
        query = f"'{folder_id}' in parents and trashed=false"
        results = service.files().list(
            q=query,
            orderBy='modifiedTime desc', # ‡πÄ‡∏≠‡∏≤‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏´‡∏°‡πà‡∏™‡∏∏‡∏î‡∏Ç‡∏∂‡πâ‡∏ô‡∏Å‡πà‡∏≠‡∏ô
            pageSize=1, 
            fields="files(id, name, mimeType)"
        ).execute()
        
        items = results.get('files', [])
        
        if not items:
            st.warning(f"üìÇ ‡πÑ‡∏°‡πà‡∏û‡∏ö‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏ô‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå ID: {folder_id}")
            return pd.DataFrame()
            
        latest_file = items[0]
        file_id = latest_file['id']
        file_name = latest_file['name']
        mime_type = latest_file['mimeType']
        
        # ‡πÅ‡∏™‡∏î‡∏á‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô
        st.toast(f"‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏ü‡∏•‡πå: {file_name}", icon="üìÑ")
        
        # 2. ‡∏Å‡∏£‡∏ì‡∏µ‡πÄ‡∏õ‡πá‡∏ô Google Sheet -> ‡πÉ‡∏ä‡πâ gspread ‡∏≠‡πà‡∏≤‡∏ô
        if mime_type == 'application/vnd.google-apps.spreadsheet':
            gc = gspread.authorize(creds)
            sh = gc.open_by_key(file_id)
            worksheet = sh.get_worksheet(0) # ‡∏≠‡πà‡∏≤‡∏ô‡∏ä‡∏µ‡∏ó‡πÅ‡∏£‡∏Å
            data = worksheet.get_all_records()
            df = pd.DataFrame(data)
            
        # 3. ‡∏Å‡∏£‡∏ì‡∏µ‡πÄ‡∏õ‡πá‡∏ô Excel (xlsx) ‡∏´‡∏£‡∏∑‡∏≠ CSV -> ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÅ‡∏•‡πâ‡∏ß‡∏≠‡πà‡∏≤‡∏ô‡∏î‡πâ‡∏ß‡∏¢ Pandas
        else:
            request = service.files().get_media(fileId=file_id)
            fh = io.BytesIO()
            downloader = MediaIoBaseDownload(fh, request)
            done = False
            while done is False:
                status, done = downloader.next_chunk()
            
            fh.seek(0)
            if 'csv' in file_name.lower():
                df = pd.read_csv(fh)
            else:
                df = pd.read_excel(fh)

        # 4. ‡πÅ‡∏õ‡∏•‡∏á‡∏´‡∏±‡∏ß‡∏ï‡∏≤‡∏£‡∏≤‡∏á (Mapping)
        if file_type == 'stock':
            # ‡πÅ‡∏õ‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ó‡∏¢ -> ‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏© (Stock)
            cols_map = {'‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û':'Image', '‡∏£‡∏´‡∏±‡∏™‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤':'Product_ID', '‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤':'Product_Name', '‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏Ñ‡∏á‡∏Ñ‡∏•‡∏±‡∏á':'Initial_Stock'}
            # ‡∏Å‡∏£‡∏≠‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡∏ó‡∏µ‡πà‡∏°‡∏µ
            df = df.rename(columns={k:v for k,v in cols_map.items() if k in df.columns})
            # ‡πÅ‡∏õ‡∏•‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç
            if 'Initial_Stock' in df.columns:
                df['Initial_Stock'] = pd.to_numeric(df['Initial_Stock'], errors='coerce').fillna(0)
                
        elif file_type == 'sale':
            # ‡πÅ‡∏õ‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ó‡∏¢ -> ‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏© (Sale)
            cols_map = {'‡πÄ‡∏ß‡∏•‡∏≤‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠':'Order_Time', '‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤':'Shop', '‡∏£‡∏´‡∏±‡∏™‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤':'Product_ID', '‡∏à‡∏≥‡∏ô‡∏ß‡∏ô':'Qty_Sold'}
            df = df.rename(columns={k:v for k,v in cols_map.items() if k in df.columns})
            # ‡πÅ‡∏õ‡∏•‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏•‡∏∞‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç
            if 'Order_Time' in df.columns:
                df['Order_Time'] = pd.to_datetime(df['Order_Time'], errors='coerce')
                df['Date'] = df['Order_Time'].dt.date
            if 'Qty_Sold' in df.columns:
                df['Qty_Sold'] = pd.to_numeric(df['Qty_Sold'], errors='coerce').fillna(0)
                
        return df
        
    except Exception as e:
        st.error(f"‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏ü‡∏•‡πå: {e}")
        return pd.DataFrame()

# ==========================================
# 4. ‡∏™‡πà‡∏ß‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏• Dashboard
# ==========================================
st.title("üìä JST Auto-Sync Dashboard")
st.caption("‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏î‡∏∂‡∏á‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà **‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î** ‡πÉ‡∏ô‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå Google Drive ‡∏°‡∏≤‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥")

with st.spinner('‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πÅ‡∏Å‡∏ô‡∏´‡∏≤‡πÑ‡∏ü‡∏•‡πå‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡πÉ‡∏ô Drive...'):
    df_stock = get_latest_dataframe_from_folder(FOLDER_ID_DATA_STOCK, "stock")
    df_sale = get_latest_dataframe_from_folder(FOLDER_ID_DATA_SALE, "sale")

if not df_stock.empty and not df_sale.empty:
    
    # --- ‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ---
    # ‡∏£‡∏ß‡∏°‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏ï‡∏≤‡∏°‡∏£‡∏´‡∏±‡∏™‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤
    sold_summary = df_sale.groupby('Product_ID')['Qty_Sold'].sum().reset_index()
    
    # ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡∏≤‡∏£‡∏≤‡∏á Stock + Sale
    merged = pd.merge(df_stock, sold_summary, on='Product_ID', how='left')
    merged['Qty_Sold'] = merged['Qty_Sold'].fillna(0)
    merged['Current_Stock'] = merged['Initial_Stock'] - merged['Qty_Sold']
    
    # ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô
    def get_status(val):
        if val <= 0: return "üî¥ ‡∏´‡∏°‡∏î‡πÄ‡∏Å‡∏•‡∏µ‡πâ‡∏¢‡∏á"
        elif val < 10: return "‚ö†Ô∏è ‡πÉ‡∏Å‡∏•‡πâ‡∏´‡∏°‡∏î"
        else: return "üü¢ ‡∏°‡∏µ‡∏Ç‡∏≠‡∏á"
    merged['Status'] = merged['Current_Stock'].apply(get_status)

    # --- ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏• Metric ---
    c1, c2, c3, c4 = st.columns(4)
    c1.metric("üì¶ ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ (Stock)", f"{len(merged)} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£")
    c2.metric("üí∞ ‡∏Ç‡∏≤‡∏¢‡∏≠‡∏≠‡∏Å‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß (Sale)", f"{int(df_sale['Qty_Sold'].sum())} ‡∏ä‡∏¥‡πâ‡∏ô")
    c3.metric("‚ö†Ô∏è ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏ï‡∏¥‡∏°‡∏Ç‡∏≠‡∏á", f"{len(merged[merged['Current_Stock'] < 10])} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£")
    c4.metric("üè™ ‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏Ç‡∏≤‡∏¢", f"{df_sale['Shop'].nunique() if 'Shop' in df_sale.columns else 0} ‡∏£‡πâ‡∏≤‡∏ô")

    st.divider()

    # --- ‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÅ‡∏•‡∏∞‡∏Å‡∏£‡∏≤‡∏ü ---
    tab1, tab2 = st.tabs(["üìâ ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢", "üì¶ ‡πÄ‡∏ä‡πá‡∏Ñ‡∏™‡∏ï‡πá‡∏≠‡∏Å‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠"])
    
    with tab1:
        col1, col2 = st.columns([2,1])
        with col1:
            if 'Date' in df_sale.columns:
                st.subheader("‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô")
                daily = df_sale.groupby('Date')['Qty_Sold'].sum().reset_index()
                st.bar_chart(daily.set_index('Date'))
        with col2:
            if 'Shop' in df_sale.columns:
                st.subheader("‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤")
                # ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏á‡πà‡∏≤‡∏¢‡πÜ ‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏ä‡πâ plotly ‡∏ñ‡πâ‡∏≤ import ‡∏°‡∏≤
                shop_summ = df_sale.groupby('Shop')['Qty_Sold'].sum().reset_index()
                st.dataframe(shop_summ, hide_index=True, use_container_width=True)
                
        st.subheader("‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î (‡∏à‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î)")
        st.dataframe(df_sale.head(10), use_container_width=True)

    with tab2:
        st.subheader("‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏™‡∏ï‡πá‡∏≠‡∏Å‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô (Stock ‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î - Sale ‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î)")
        
        status_filter = st.multiselect("‡∏Å‡∏£‡∏≠‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞:", ["üî¥ ‡∏´‡∏°‡∏î‡πÄ‡∏Å‡∏•‡∏µ‡πâ‡∏¢‡∏á", "‚ö†Ô∏è ‡πÉ‡∏Å‡∏•‡πâ‡∏´‡∏°‡∏î", "üü¢ ‡∏°‡∏µ‡∏Ç‡∏≠‡∏á"], default=["üî¥ ‡∏´‡∏°‡∏î‡πÄ‡∏Å‡∏•‡∏µ‡πâ‡∏¢‡∏á", "‚ö†Ô∏è ‡πÉ‡∏Å‡∏•‡πâ‡∏´‡∏°‡∏î"])
        display_df = merged[merged['Status'].isin(status_filter)]
        
        st.data_editor(
            display_df[['Image', 'Product_ID', 'Product_Name', 'Initial_Stock', 'Qty_Sold', 'Current_Stock', 'Status']],
            column_config={
                "Image": st.column_config.ImageColumn("‡∏£‡∏π‡∏õ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤"),
                "Product_ID": "‡∏£‡∏´‡∏±‡∏™",
                "Product_Name": "‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤",
                "Initial_Stock": st.column_config.NumberColumn("‡∏™‡∏ï‡πá‡∏≠‡∏Å‡∏ï‡∏±‡πâ‡∏á‡∏ï‡πâ‡∏ô"),
                "Qty_Sold": st.column_config.NumberColumn("‡∏Ç‡∏≤‡∏¢‡πÑ‡∏õ"),
                "Current_Stock": st.column_config.ProgressColumn("‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠", format="%d", min_value=0, max_value=int(merged['Initial_Stock'].max())),
            },
            use_container_width=True,
            height=600,
            hide_index=True
        )

else:
    st.info("‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏£‡∏≠‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠... ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏û‡∏ö‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏ô‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå")
    st.write("‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥: ‡πÇ‡∏õ‡∏£‡∏î‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏°‡∏µ‡πÑ‡∏ü‡∏•‡πå Excel (.xlsx) ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå DATA STOCK ‡πÅ‡∏•‡∏∞ DATA SALE ‡∏ö‡∏ô Google Drive ‡πÅ‡∏•‡πâ‡∏ß")